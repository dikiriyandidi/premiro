!function(t){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return t(e,window,document)}):"object"==typeof exports?module.exports=function(e,n){return e||(e=window),n&&n.fn.dataTable||(n=require("datatables.net")(e,n).$),t(n,e,e.document)}:t(jQuery,window,document)}(function(t,e,n,i){"use strict";var o=t.fn.dataTable,r=0,s=0,a=o.ext.buttons,l=function(e,n){n===!0&&(n={}),t.isArray(n)&&(n={buttons:n}),this.c=t.extend(!0,{},l.defaults,n),n.buttons&&(this.c.buttons=n.buttons),this.s={dt:new o.Api(e),buttons:[],listenKeys:"",namespace:"dtb"+r++},this.dom={container:t("<"+this.c.dom.container.tag+"/>").addClass(this.c.dom.container.className)},this._constructor()};t.extend(l.prototype,{action:function(t,e){var n=this._nodeToButton(t);return e===i?n.conf.action:(n.conf.action=e,this)},active:function(e,n){var o=this._nodeToButton(e),r=this.c.dom.button.active,s=t(o.node);return n===i?s.hasClass(r):(s.toggleClass(r,n===i?!0:n),this)},add:function(t,e){var n=this.s.buttons;if("string"==typeof e){for(var i=e.split("-"),o=this.s,r=0,s=i.length-1;s>r;r++)o=o.buttons[1*i[r]];n=o.buttons,e=1*i[i.length-1]}return this._expandButton(n,t,!1,e),this._draw(),this},container:function(){return this.dom.container},disable:function(e){var n=this._nodeToButton(e);return t(n.node).addClass(this.c.dom.button.disabled),this},destroy:function(){t("body").off("keyup."+this.s.namespace);var e,n,i=this.s.buttons.slice();for(e=0,n=i.length;n>e;e++)this.remove(i[e].node);this.dom.container.remove();var o=this.s.dt.settings()[0];for(e=0,n=o.length;n>e;e++)if(o.inst===this){o.splice(e,1);break}return this},enable:function(e,n){if(n===!1)return this.disable(e);var i=this._nodeToButton(e);return t(i.node).removeClass(this.c.dom.button.disabled),this},name:function(){return this.c.name},node:function(e){var n=this._nodeToButton(e);return t(n.node)},remove:function(e){var n=this._nodeToButton(e),i=this._nodeToHost(e),o=this.s.dt;if(n.buttons.length)for(var r=n.buttons.length-1;r>=0;r--)this.remove(n.buttons[r].node);n.conf.destroy&&n.conf.destroy.call(o.button(e),o,t(e),n.conf),this._removeKey(n.conf),t(n.node).remove();var s=t.inArray(n,i);return i.splice(s,1),this},text:function(e,n){var o=this._nodeToButton(e),r=this.c.dom.collection.buttonLiner,s=o.inCollection&&r&&r.tag?r.tag:this.c.dom.buttonLiner.tag,a=this.s.dt,l=t(o.node),u=function(t){return"function"==typeof t?t(a,l,o.conf):t};return n===i?u(o.conf.text):(o.conf.text=n,s?l.children(s).html(u(n)):l.html(u(n)),this)},_constructor:function(){var e=this,i=this.s.dt,o=i.settings()[0],r=this.c.buttons;o._buttons||(o._buttons=[]),o._buttons.push({inst:this,name:this.c.name});for(var s=0,a=r.length;a>s;s++)this.add(r[s]);i.on("destroy",function(){e.destroy()}),t("body").on("keyup."+this.s.namespace,function(t){if(!n.activeElement||n.activeElement===n.body){var i=String.fromCharCode(t.keyCode).toLowerCase();-1!==e.s.listenKeys.toLowerCase().indexOf(i)&&e._keypress(i,t)}})},_addKey:function(e){e.key&&(this.s.listenKeys+=t.isPlainObject(e.key)?e.key.key:e.key)},_draw:function(t,e){t||(t=this.dom.container,e=this.s.buttons),t.children().detach();for(var n=0,i=e.length;i>n;n++)t.append(e[n].inserter),e[n].buttons&&e[n].buttons.length&&this._draw(e[n].collection,e[n].buttons)},_expandButton:function(e,n,o,r){for(var s=this.s.dt,a=0,l=t.isArray(n)?n:[n],u=0,h=l.length;h>u;u++){var c=this._resolveExtends(l[u]);if(c)if(t.isArray(c))this._expandButton(e,c,o,r);else{var d=this._buildButton(c,o);if(d){if(r!==i?(e.splice(r,0,d),r++):e.push(d),d.conf.buttons){var p=this.c.dom.collection;d.collection=t("<"+p.tag+"/>").addClass(p.className),d.conf._collection=d.collection,this._expandButton(d.buttons,d.conf.buttons,!0,r)}c.init&&c.init.call(s.button(d.node),s,t(d.node),c),a++}}}},_buildButton:function(e,n){var i=this.c.dom.button,o=this.c.dom.buttonLiner,r=this.c.dom.collection,a=this.s.dt,l=function(t){return"function"==typeof t?t(a,h,e):t};if(n&&r.button&&(i=r.button),n&&r.buttonLiner&&(o=r.buttonLiner),e.available&&!e.available(a,e))return!1;var u=function(e,n,i,o){o.action.call(n.button(i),e,n,i,o),t(n.table().node()).triggerHandler("buttons-action.dt",[n.button(i),n,i,o])},h=t("<"+i.tag+"/>").addClass(i.className).attr("tabindex",this.s.dt.settings()[0].iTabIndex).attr("aria-controls",this.s.dt.table().node().id).on("click.dtb",function(t){t.preventDefault(),!h.hasClass(i.disabled)&&e.action&&u(t,a,h,e),h.blur()}).on("keyup.dtb",function(t){13===t.keyCode&&!h.hasClass(i.disabled)&&e.action&&u(t,a,h,e)});if("a"===i.tag.toLowerCase()&&h.attr("href","#"),o.tag){var c=t("<"+o.tag+"/>").html(l(e.text)).addClass(o.className);"a"===o.tag.toLowerCase()&&c.attr("href","#"),h.append(c)}else h.html(l(e.text));e.enabled===!1&&h.addClass(i.disabled),e.className&&h.addClass(e.className),e.titleAttr&&h.attr("title",e.titleAttr),e.namespace||(e.namespace=".dt-button-"+s++);var d,p=this.c.dom.buttonContainer;return d=p&&p.tag?t("<"+p.tag+"/>").addClass(p.className).append(h):h,this._addKey(e),{conf:e,node:h.get(0),inserter:d,buttons:[],inCollection:n,collection:null}},_nodeToButton:function(t,e){e||(e=this.s.buttons);for(var n=0,i=e.length;i>n;n++){if(e[n].node===t)return e[n];if(e[n].buttons.length){var o=this._nodeToButton(t,e[n].buttons);if(o)return o}}},_nodeToHost:function(t,e){e||(e=this.s.buttons);for(var n=0,i=e.length;i>n;n++){if(e[n].node===t)return e;if(e[n].buttons.length){var o=this._nodeToHost(t,e[n].buttons);if(o)return o}}},_keypress:function(e,n){var i=function(i,o){if(i.key)if(i.key===e)t(o).click();else if(t.isPlainObject(i.key)){if(i.key.key!==e)return;if(i.key.shiftKey&&!n.shiftKey)return;if(i.key.altKey&&!n.altKey)return;if(i.key.ctrlKey&&!n.ctrlKey)return;if(i.key.metaKey&&!n.metaKey)return;t(o).click()}},o=function(t){for(var e=0,n=t.length;n>e;e++)i(t[e].conf,t[e].node),t[e].buttons.length&&o(t[e].buttons)};o(this.s.buttons)},_removeKey:function(e){if(e.key){var n=t.isPlainObject(e.key)?e.key.key:e.key,i=this.s.listenKeys.split(""),o=t.inArray(n,i);i.splice(o,1),this.s.listenKeys=i.join("")}},_resolveExtends:function(e){var n,o,r=this.s.dt,s=function(n){for(var o=0;!t.isPlainObject(n)&&!t.isArray(n);){if(n===i)return;if("function"==typeof n){if(n=n(r,e),!n)return!1}else if("string"==typeof n){if(!a[n])throw"Unknown button type: "+n;n=a[n]}if(o++,o>30)throw"Buttons: Too many iterations"}return t.isArray(n)?n:t.extend({},n)};for(e=s(e);e&&e.extend;){if(!a[e.extend])throw"Cannot extend unknown button type: "+e.extend;var l=s(a[e.extend]);if(t.isArray(l))return l;if(!l)return!1;var u=l.className;e=t.extend({},l,e),u&&e.className!==u&&(e.className=u+" "+e.className);var h=e.postfixButtons;if(h){for(e.buttons||(e.buttons=[]),n=0,o=h.length;o>n;n++)e.buttons.push(h[n]);e.postfixButtons=null}var c=e.prefixButtons;if(c){for(e.buttons||(e.buttons=[]),n=0,o=c.length;o>n;n++)e.buttons.splice(n,0,c[n]);e.prefixButtons=null}e.extend=l.extend}return e}}),l.background=function(e,n,o){o===i&&(o=400),e?t("<div/>").addClass(n).css("display","none").appendTo("body").fadeIn(o):t("body > div."+n).fadeOut(o,function(){t(this).removeClass(n).remove()})},l.instanceSelector=function(e,n){if(!e)return t.map(n,function(t){return t.inst});var i=[],o=t.map(n,function(t){return t.name}),r=function(e){if(t.isArray(e))for(var s=0,a=e.length;a>s;s++)r(e[s]);else if("string"==typeof e)if(-1!==e.indexOf(","))r(e.split(","));else{var l=t.inArray(t.trim(e),o);-1!==l&&i.push(n[l].inst)}else"number"==typeof e&&i.push(n[e].inst)};return r(e),i},l.buttonSelector=function(e,n){for(var o=[],r=function(t,e,n){for(var o,s,a=0,l=e.length;l>a;a++)o=e[a],o&&(s=n!==i?n+a:a+"",t.push({node:o.node,name:o.conf.name,idx:s}),o.buttons&&r(t,o.buttons,s+"-"))},s=function(e,n){var a,l,u=[];r(u,n.s.buttons);var h=t.map(u,function(t){return t.node});if(t.isArray(e)||e instanceof t)for(a=0,l=e.length;l>a;a++)s(e[a],n);else if(null===e||e===i||"*"===e)for(a=0,l=u.length;l>a;a++)o.push({inst:n,node:u[a].node});else if("number"==typeof e)o.push({inst:n,node:n.s.buttons[e].node});else if("string"==typeof e)if(-1!==e.indexOf(",")){var c=e.split(",");for(a=0,l=c.length;l>a;a++)s(t.trim(c[a]),n)}else if(e.match(/^\d+(\-\d+)*$/)){var d=t.map(u,function(t){return t.idx});o.push({inst:n,node:u[t.inArray(e,d)].node})}else if(-1!==e.indexOf(":name")){var p=e.replace(":name","");for(a=0,l=u.length;l>a;a++)u[a].name===p&&o.push({inst:n,node:u[a].node})}else t(h).filter(e).each(function(){o.push({inst:n,node:this})});else if("object"==typeof e&&e.nodeName){var f=t.inArray(e,h);-1!==f&&o.push({inst:n,node:h[f]})}},a=0,l=e.length;l>a;a++){var u=e[a];s(n,u)}return o},l.defaults={buttons:["copy","excel","csv","pdf","print"],name:"main",tabIndex:0,dom:{container:{tag:"div",className:"dt-buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"dt-button",active:"active",disabled:"disabled"},buttonLiner:{tag:"span",className:""}}},l.version="1.2.4",t.extend(a,{collection:{text:function(t){return t.i18n("buttons.collection","Collection")},className:"buttons-collection",action:function(n,i,o,r){var s=o,a=s.offset(),u=t(i.table().container()),h=!1;t("div.dt-button-background").length&&(h=t(".dt-button-collection").offset(),t("body").trigger("click.dtb-collection")),r._collection.addClass(r.collectionLayout).css("display","none").appendTo("body").fadeIn(r.fade);var c=r._collection.css("position");if(h&&"absolute"===c)r._collection.css({top:h.top,left:h.left});else if("absolute"===c){r._collection.css({top:a.top+s.outerHeight(),left:a.left});var d=a.left+r._collection.outerWidth(),p=u.offset().left+u.width();d>p&&r._collection.css("left",a.left-(d-p))}else{var f=r._collection.height()/2;f>t(e).height()/2&&(f=t(e).height()/2),r._collection.css("marginTop",-1*f)}r.background&&l.background(!0,r.backgroundClassName,r.fade),setTimeout(function(){t("div.dt-button-background").on("click.dtb-collection",function(){}),t("body").on("click.dtb-collection",function(e){var n=t.fn.addBack?"addBack":"andSelf";t(e.target).parents()[n]().filter(r._collection).length||(r._collection.fadeOut(r.fade,function(){r._collection.detach()}),t("div.dt-button-background").off("click.dtb-collection"),l.background(!1,r.backgroundClassName,r.fade),t("body").off("click.dtb-collection"),i.off("buttons-action.b-internal"))})},10),r.autoClose&&i.on("buttons-action.b-internal",function(){t("div.dt-button-background").click()})},background:!0,collectionLayout:"",backgroundClassName:"dt-button-background",autoClose:!1,fade:400},copy:function(t,e){return a.copyHtml5?"copyHtml5":a.copyFlash&&a.copyFlash.available(t,e)?"copyFlash":void 0},csv:function(t,e){return a.csvHtml5&&a.csvHtml5.available(t,e)?"csvHtml5":a.csvFlash&&a.csvFlash.available(t,e)?"csvFlash":void 0},excel:function(t,e){return a.excelHtml5&&a.excelHtml5.available(t,e)?"excelHtml5":a.excelFlash&&a.excelFlash.available(t,e)?"excelFlash":void 0},pdf:function(t,e){return a.pdfHtml5&&a.pdfHtml5.available(t,e)?"pdfHtml5":a.pdfFlash&&a.pdfFlash.available(t,e)?"pdfFlash":void 0},pageLength:function(e){var n=e.settings()[0].aLengthMenu,i=t.isArray(n[0])?n[0]:n,o=t.isArray(n[0])?n[1]:n,r=function(t){return t.i18n("buttons.pageLength",{"-1":"Show all rows",_:"Show %d rows"},t.page.len())};return{extend:"collection",text:r,className:"buttons-page-length",autoClose:!0,buttons:t.map(i,function(t,e){return{text:o[e],className:"button-page-length",action:function(e,n){n.page.len(t).draw()},init:function(e,n,i){var o=this,r=function(){o.active(e.page.len()===t)};e.on("length.dt"+i.namespace,r),r()},destroy:function(t,e,n){t.off("length.dt"+n.namespace)}}}),init:function(t,e,n){var i=this;t.on("length.dt"+n.namespace,function(){i.text(r(t))})},destroy:function(t,e,n){t.off("length.dt"+n.namespace)}}}}),o.Api.register("buttons()",function(t,e){e===i&&(e=t,t=i),this.selector.buttonGroup=t;var n=this.iterator(!0,"table",function(n){return n._buttons?l.buttonSelector(l.instanceSelector(t,n._buttons),e):void 0},!0);return n._groupSelector=t,n}),o.Api.register("button()",function(t,e){var n=this.buttons(t,e);return n.length>1&&n.splice(1,n.length),n}),o.Api.registerPlural("buttons().active()","button().active()",function(t){return t===i?this.map(function(t){return t.inst.active(t.node)}):this.each(function(e){e.inst.active(e.node,t)})}),o.Api.registerPlural("buttons().action()","button().action()",function(t){return t===i?this.map(function(t){return t.inst.action(t.node)}):this.each(function(e){e.inst.action(e.node,t)})}),o.Api.register(["buttons().enable()","button().enable()"],function(t){return this.each(function(e){e.inst.enable(e.node,t)})}),o.Api.register(["buttons().disable()","button().disable()"],function(){return this.each(function(t){t.inst.disable(t.node)})}),o.Api.registerPlural("buttons().nodes()","button().node()",function(){var e=t();return t(this.each(function(t){e=e.add(t.inst.node(t.node))})),e}),o.Api.registerPlural("buttons().text()","button().text()",function(t){return t===i?this.map(function(t){return t.inst.text(t.node)}):this.each(function(e){e.inst.text(e.node,t)})}),o.Api.registerPlural("buttons().trigger()","button().trigger()",function(){return this.each(function(t){t.inst.node(t.node).trigger("click")})}),o.Api.registerPlural("buttons().containers()","buttons().container()",function(){var e=t(),n=this._groupSelector;return this.iterator(!0,"table",function(t){if(t._buttons)for(var i=l.instanceSelector(n,t._buttons),o=0,r=i.length;r>o;o++)e=e.add(i[o].container())}),e}),o.Api.register("button().add()",function(t,e){var n=this.context;if(n.length){var i=l.instanceSelector(this._groupSelector,n[0]._buttons);i.length&&i[0].add(e,t)}return this.button(this._groupSelector,t)}),o.Api.register("buttons().destroy()",function(){return this.pluck("inst").unique().each(function(t){t.destroy()}),this}),o.Api.registerPlural("buttons().remove()","buttons().remove()",function(){return this.each(function(t){t.inst.remove(t.node)}),this});var u;o.Api.register("buttons.info()",function(e,n,o){var r=this;return e===!1?(t("#datatables_buttons_info").fadeOut(function(){t(this).remove()}),clearTimeout(u),u=null,this):(u&&clearTimeout(u),t("#datatables_buttons_info").length&&t("#datatables_buttons_info").remove(),e=e?"<h2>"+e+"</h2>":"",t('<div id="datatables_buttons_info" class="dt-button-info"/>').html(e).append(t("<div/>")["string"==typeof n?"html":"append"](n)).css("display","none").appendTo("body").fadeIn(),o!==i&&0!==o&&(u=setTimeout(function(){r.buttons.info(!1)},o)),this)}),o.Api.register("buttons.exportData()",function(t){return this.context.length?c(new o.Api(this.context[0]),t):void 0});var h=t("<textarea/>")[0],c=function(e,n){for(var i=t.extend(!0,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:!0,stripNewlines:!0,decodeEntities:!0,trim:!0,format:{header:function(t){return o(t)},footer:function(t){return o(t)},body:function(t){return o(t)}}},n),o=function(t){return"string"!=typeof t?t:(i.stripHtml&&(t=t.replace(/<[^>]*>/g,"")),i.trim&&(t=t.replace(/^\s+|\s+$/g,"")),i.stripNewlines&&(t=t.replace(/\n/g," ")),i.decodeEntities&&(h.innerHTML=t,t=h.value),t)},r=e.columns(i.columns).indexes().map(function(t){var n=e.column(t).header();return i.format.header(n.innerHTML,t,n)}).toArray(),s=e.table().footer()?e.columns(i.columns).indexes().map(function(t){var n=e.column(t).footer();return i.format.footer(n?n.innerHTML:"",t,n)}).toArray():null,a=e.rows(i.rows,i.modifier).indexes().toArray(),l=e.cells(a,i.columns),u=l.render(i.orthogonal).toArray(),c=l.nodes().toArray(),d=r.length,p=d>0?u.length/d:0,f=new Array(p),g=0,m=0,v=p;v>m;m++){for(var y=new Array(d),b=0;d>b;b++)y[b]=i.format.body(u[g],m,b,c[g]),g++;f[m]=y}return{header:r,footer:s,body:f}};return t.fn.dataTable.Buttons=l,t.fn.DataTable.Buttons=l,t(n).on("init.dt plugin-init.dt",function(t,e){if("dt"===t.namespace){var n=e.oInit.buttons||o.defaults.buttons;n&&!e._buttons&&new l(e,n).container()}}),o.ext.feature.push({fnInit:function(t){var e=new o.Api(t),n=e.init().buttons||o.defaults.buttons;return new l(e,n).container()},cFeature:"B"}),l});
