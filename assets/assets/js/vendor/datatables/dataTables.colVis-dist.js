!function(t,e,n){var i=function(t){"use strict";var i=function(e,n){this.CLASS&&"ColVis"==this.CLASS||alert("Warning: ColVis must be initialised with the keyword 'new'"),"undefined"==typeof n&&(n={});var r=t.fn.dataTable.camelToHungarian;return r&&(r(i.defaults,i.defaults,!0),r(i.defaults,n)),this.s={dt:null,oInit:n,hidden:!0,abOriginal:[]},this.dom={wrapper:null,button:null,collection:null,background:null,catcher:null,buttons:[],groupButtons:[],restore:null},i.aInstances.push(this),this.s.dt=t.fn.dataTable.Api?new t.fn.dataTable.Api(e).settings()[0]:e,this._fnConstruct(n),this};return i.prototype={button:function(){return this.dom.wrapper},fnRebuild:function(){this.rebuild()},rebuild:function(){for(var t=this.dom.buttons.length-1;t>=0;t--)this.dom.collection.removeChild(this.dom.buttons[t]);this.dom.buttons.splice(0,this.dom.buttons.length),this.dom.groupButtons.splice(0,this.dom.groupButtons.length),this.dom.restore&&this.dom.restore.parentNode(this.dom.restore),this._fnAddGroups(),this._fnAddButtons(),this._fnDrawCallback()},_fnConstruct:function(n){this._fnApplyCustomisation(n);var i,r,o=this;for(this.dom.wrapper=e.createElement("div"),this.dom.wrapper.className="ColVis",this.dom.button=t("<button />",{"class":this.s.dt.bJUI?"ColVis_Button ColVis_MasterButton ui-button ui-state-default":"ColVis_Button ColVis_MasterButton"}).append("<span>"+this.s.buttonText+"</span>").bind("mouseover"==this.s.activate?"mouseover":"click",function(t){t.preventDefault(),o._fnCollectionShow()}).appendTo(this.dom.wrapper)[0],this.dom.catcher=this._fnDomCatcher(),this.dom.collection=this._fnDomCollection(),this.dom.background=this._fnDomBackground(),this._fnAddGroups(),this._fnAddButtons(),i=0,r=this.s.dt.aoColumns.length;r>i;i++)this.s.abOriginal.push(this.s.dt.aoColumns[i].bVisible);this.s.dt.aoDrawCallback.push({fn:function(){o._fnDrawCallback.call(o)},sName:"ColVis"}),t(this.s.dt.oInstance).bind("column-reorder.dt",function(t,e,n){for(i=0,r=o.s.aiExclude.length;r>i;i++)o.s.aiExclude[i]=n.aiInvertMapping[o.s.aiExclude[i]];var s=o.s.abOriginal.splice(n.iFrom,1)[0];o.s.abOriginal.splice(n.iTo,0,s),o.fnRebuild()}),t(this.s.dt.oInstance).bind("destroy.dt",function(){t(o.dom.wrapper).remove()}),this._fnDrawCallback()},_fnApplyCustomisation:function(e){t.extend(!0,this.s,i.defaults,e),!this.s.showAll&&this.s.bShowAll&&(this.s.showAll=this.s.sShowAll),!this.s.restore&&this.s.bRestore&&(this.s.restore=this.s.sRestore);var n=this.s.groups,r=this.s.aoGroups;if(n)for(var o=0,s=n.length;s>o;o++)n[o].title&&(r[o].sTitle=n[o].title),n[o].columns&&(r[o].aiColumns=n[o].columns)},_fnDrawCallback:function(){for(var e,i=this.s.dt.aoColumns,r=this.dom.buttons,o=this.s.aoGroups,s=0,a=r.length;a>s;s++)e=r[s],e.__columnIdx!==n&&t("input",e).prop("checked",i[e.__columnIdx].bVisible);for(var l=function(t){for(var e=0,n=t.length;n>e;e++)if(i[t[e]].bVisible===!1)return!1;return!0},u=function(t){for(var e=0,n=t.length;n>e;e++)if(i[t[e]].bVisible===!0)return!1;return!0},h=0,c=o.length;c>h;h++)l(o[h].aiColumns)?(t("input",this.dom.groupButtons[h]).prop("checked",!0),t("input",this.dom.groupButtons[h]).prop("indeterminate",!1)):u(o[h].aiColumns)?(t("input",this.dom.groupButtons[h]).prop("checked",!1),t("input",this.dom.groupButtons[h]).prop("indeterminate",!1)):t("input",this.dom.groupButtons[h]).prop("indeterminate",!0)},_fnAddGroups:function(){var t;if("undefined"!=typeof this.s.aoGroups)for(var e=0,n=this.s.aoGroups.length;n>e;e++)t=this._fnDomGroupButton(e),this.dom.groupButtons.push(t),this.dom.buttons.push(t),this.dom.collection.appendChild(t)},_fnAddButtons:function(){var e,n=this.s.dt.aoColumns;if(-1===t.inArray("all",this.s.aiExclude))for(var i=0,r=n.length;r>i;i++)-1===t.inArray(i,this.s.aiExclude)&&(e=this._fnDomColumnButton(i),e.__columnIdx=i,this.dom.buttons.push(e));"alpha"===this.s.order&&this.dom.buttons.sort(function(t,e){var i=n[t.__columnIdx].sTitle,r=n[e.__columnIdx].sTitle;return i===r?0:r>i?-1:1}),this.s.restore&&(e=this._fnDomRestoreButton(),e.className+=" ColVis_Restore",this.dom.buttons.push(e)),this.s.showAll&&(e=this._fnDomShowXButton(this.s.showAll,!0),e.className+=" ColVis_ShowAll",this.dom.buttons.push(e)),this.s.showNone&&(e=this._fnDomShowXButton(this.s.showNone,!1),e.className+=" ColVis_ShowNone",this.dom.buttons.push(e)),t(this.dom.collection).append(this.dom.buttons)},_fnDomRestoreButton:function(){var e=this,n=this.s.dt;return t('<li class="ColVis_Special '+(n.bJUI?"ui-button ui-state-default":"")+'">'+this.s.restore+"</li>").click(function(){for(var t=0,n=e.s.abOriginal.length;n>t;t++)e.s.dt.oInstance.fnSetColumnVis(t,e.s.abOriginal[t],!1);e._fnAdjustOpenRows(),e.s.dt.oInstance.fnAdjustColumnSizing(!1),e.s.dt.oInstance.fnDraw(!1)})[0]},_fnDomShowXButton:function(e,n){var i=this,r=this.s.dt;return t('<li class="ColVis_Special '+(r.bJUI?"ui-button ui-state-default":"")+'">'+e+"</li>").click(function(){for(var t=0,e=i.s.abOriginal.length;e>t;t++)-1===i.s.aiExclude.indexOf(t)&&i.s.dt.oInstance.fnSetColumnVis(t,n,!1);i._fnAdjustOpenRows(),i.s.dt.oInstance.fnAdjustColumnSizing(!1),i.s.dt.oInstance.fnDraw(!1)})[0]},_fnDomGroupButton:function(e){var n=this,i=this.s.dt,r=this.s.aoGroups[e];return t('<li class="ColVis_Special '+(i.bJUI?"ui-button ui-state-default":"")+'"><label><input type="checkbox" /><span>'+r.sTitle+"</span></label></li>").click(function(e){var i=!t("input",this).is(":checked");"li"!==e.target.nodeName.toLowerCase()&&(i=!i);for(var o=0;o<r.aiColumns.length;o++)n.s.dt.oInstance.fnSetColumnVis(r.aiColumns[o],i)})[0]},_fnDomColumnButton:function(e){var n=this,i=this.s.dt.aoColumns[e],r=this.s.dt,o=null===this.s.fnLabel?i.sTitle:this.s.fnLabel(e,i.sTitle,i.nTh);return t("<li "+(r.bJUI?'class="ui-button ui-state-default"':"")+'><label><input type="checkbox" /><span>'+o+"</span></label></li>").click(function(i){var o=!t("input",this).is(":checked");"li"!==i.target.nodeName.toLowerCase()&&("input"==i.target.nodeName.toLowerCase()||null===n.s.fnStateChange)&&(o=!o);var s=t.fn.dataTableExt.iApiIndex;t.fn.dataTableExt.iApiIndex=n._fnDataTablesApiIndex.call(n),r.oFeatures.bServerSide?(n.s.dt.oInstance.fnSetColumnVis(e,o,!1),n.s.dt.oInstance.fnAdjustColumnSizing(!1),(""!==r.oScroll.sX||""!==r.oScroll.sY)&&n.s.dt.oInstance.oApi._fnScrollDraw(n.s.dt),n._fnDrawCallback()):n.s.dt.oInstance.fnSetColumnVis(e,o),t.fn.dataTableExt.iApiIndex=s,null!==n.s.fnStateChange&&("span"==i.target.nodeName.toLowerCase()&&i.preventDefault(),n.s.fnStateChange.call(n,e,o))})[0]},_fnDataTablesApiIndex:function(){for(var t=0,e=this.s.dt.oInstance.length;e>t;t++)if(this.s.dt.oInstance[t]==this.s.dt.nTable)return t;return 0},_fnDomCollection:function(){return t("<ul />",{"class":this.s.dt.bJUI?"ColVis_collection ui-buttonset ui-buttonset-multi":"ColVis_collection"}).css({display:"none",opacity:0,position:this.s.bCssPosition?"":"absolute"})[0]},_fnDomCatcher:function(){var n=this,i=e.createElement("div");return i.className="ColVis_catcher",t(i).click(function(){n._fnCollectionHide.call(n,null,null)}),i},_fnDomBackground:function(){var e=this,n=t("<div></div>").addClass("ColVis_collectionBackground").css("opacity",0).click(function(){e._fnCollectionHide.call(e,null,null)});return"mouseover"==this.s.activate&&n.mouseover(function(){e.s.overcollection=!1,e._fnCollectionHide.call(e,null,null)}),n[0]},_fnCollectionShow:function(){var n,i=this,r=t(this.dom.button).offset(),o=this.dom.collection,s=this.dom.background,a=parseInt(r.left,10),l=parseInt(r.top+t(this.dom.button).outerHeight(),10);this.s.bCssPosition||(o.style.top=l+"px",o.style.left=a+"px"),t(o).css({display:"block",opacity:0}),s.style.bottom="0px",s.style.right="0px";var u=this.dom.catcher.style;if(u.height=t(this.dom.button).outerHeight()+"px",u.width=t(this.dom.button).outerWidth()+"px",u.top=r.top+"px",u.left=a+"px",e.body.appendChild(s),e.body.appendChild(o),e.body.appendChild(this.dom.catcher),t(o).animate({opacity:1},i.s.iOverlayFade),t(s).animate({opacity:.1},i.s.iOverlayFade,"linear",function(){t.browser&&t.browser.msie&&"6.0"==t.browser.version&&i._fnDrawCallback()}),!this.s.bCssPosition){n="left"==this.s.sAlign?a:a-t(o).outerWidth()+t(this.dom.button).outerWidth(),o.style.left=n+"px";var h=t(o).outerWidth(),c=(t(o).outerHeight(),t(e).width());n+h>c&&(o.style.left=c-h+"px")}this.s.hidden=!1},_fnCollectionHide:function(){var n=this;this.s.hidden||null===this.dom.collection||(this.s.hidden=!0,t(this.dom.collection).animate({opacity:0},n.s.iOverlayFade,function(){this.style.display="none"}),t(this.dom.background).animate({opacity:0},n.s.iOverlayFade,function(){e.body.removeChild(n.dom.background),e.body.removeChild(n.dom.catcher)}))},_fnAdjustOpenRows:function(){for(var t=this.s.dt.aoOpenRows,e=this.s.dt.oApi._fnVisbleColumns(this.s.dt),n=0,i=t.length;i>n;n++)t[n].nTr.getElementsByTagName("td")[0].colSpan=e}},i.fnRebuild=function(e){var n=null;"undefined"!=typeof e&&(n=t.fn.dataTable.Api?new t.fn.dataTable.Api(e).table().node():e.fnSettings().nTable);for(var r=0,o=i.aInstances.length;o>r;r++)("undefined"==typeof e||n==i.aInstances[r].s.dt.nTable)&&i.aInstances[r].fnRebuild()},i.defaults={active:"click",buttonText:"Show / hide columns",aiExclude:[],bRestore:!1,sRestore:"Restore original",bShowAll:!1,sShowAll:"Show All",sAlign:"left",fnStateChange:null,iOverlayFade:500,fnLabel:null,bCssPosition:!1,aoGroups:[],order:"column"},i.aInstances=[],i.prototype.CLASS="ColVis",i.VERSION="1.1.2",i.prototype.VERSION=i.VERSION,"function"==typeof t.fn.dataTable&&"function"==typeof t.fn.dataTableExt.fnVersionCheck&&t.fn.dataTableExt.fnVersionCheck("1.7.0")?t.fn.dataTableExt.aoFeatures.push({fnInit:function(t){var e=t.oInit,n=new i(t,e.colVis||e.oColVis||{});return n.button()},cFeature:"C",sFeature:"ColVis"}):alert("Warning: ColVis requires DataTables 1.7 or greater - www.datatables.net/download"),t.fn.dataTable.ColVis=i,t.fn.DataTable.ColVis=i,i};"function"==typeof define&&define.amd?define(["jquery","datatables"],i):"object"==typeof exports?i(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.ColVis&&i(jQuery,jQuery.fn.dataTable)}(window,document);
